# ID: NP0-05

## Title

Security verification: response-header + nonce E2E contracts

## Context

CSP/security headers and nonce-based scripts are security-critical and easy to regress. Unit tests exist for CSP string generation, but response-level enforcement needs a reliable test contract (and ideally a “report-only” rollout plan).

## Steps

1. Add e2e tests that assert security headers exist in HTTP responses for:
   - `/`
   - a PDF tool route
   - `/offline`
2. Assert at least one inline JSON-LD script includes a nonce attribute that matches CSP requirements.
3. Add negative tests:
   - ensure `Strict-Transport-Security` is not set in non-production envs
4. Add a “CSP rollout” doc: report-only → enforced plan (same-origin reporting endpoint if used).

## Acceptance Criteria

- CI fails if CSP/headers are missing or nonce breaks.
- Policies do not break SW/worker/fonts.

## Dependencies

- Requires CSP enforcement to exist (middleware/headers).

## Files to modify

- `tests/e2e/*`
- `proxy.ts`
- `middleware.ts`
- `docs/technical/security/*`
